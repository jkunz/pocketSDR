!function(e,t){"function"==typeof define&&define.amd?define(["crypto-js","moment"],t):"object"==typeof exports?module.exports=t(require("crypto-js"),require("moment")):e.wsse=t(e.CryptoJS,e.moment)}(this,function(e,t){"use strict";var n={};return n.buildWsseHeader=function(e){var t=e.username,s=e.passwordEncoded,r=n.generateNonce(),o=n.generateCreatedDate(),a=n.generatePasswordDigest(r,o,s);return'UsernameToken Username="'+t+'", PasswordDigest="'+a+'", Nonce="'+r+'", Created="'+o+'"'},n.generateNonce=function(){var t=Math.random().toString(36).substring(2);return e.enc.Utf8.parse(t).toString(e.enc.Base64)},n.generatePasswordDigest=function(t,s,r){var o=t.concat(s).concat(r);o=n.useSaltOnDigest&&"undefined"!=typeof n.salt&&n.salt.length?o+"{"+n.salt+"}":o;var a=e.SHA1(o),i=a.toString(e.enc.Base64);return i},n.encodePassword=function(t,s){n.salt=n.useSaltOnDigest?s:void 0;for(var r="undefined"!=typeof s&&s.length?t+"{"+s+"}":t,o=e.SHA512(r),a=1;a<n.passwordEncodingIterations;a++)o=e.SHA512(o.concat(e.enc.Utf8.parse(r)));var i=n.passwordEncodingAsBase64?o.toString(e.enc.Base64):o;return i},n.generateCreatedDate=function(){return n.secondsToSubtract?t().subtract(n.secondsToSubtract,"seconds").format():t().format()},n.setup=function(e){e=e||{},n.passwordEncodingIterations=e.passwordEncodingIterations||5e3,n.secondsToSubtract=e.secondsToSubtract||0,n.passwordEncodingAsBase64=e.passwordEncodingAsBase64===!1?!1:!0,n.useSaltOnDigest=e.useSaltOnDigest===!0?!0:!1},n.buildHttpHeader=function(e){var t=n.buildWsseHeader(e),s={Authorization:'WSSE profile="UsernameToken"',"X-WSSE":t};return s},n});